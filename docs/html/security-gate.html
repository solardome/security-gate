<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>security-gate Documentation Pack</title>
  <style>
    :root {
      --solar: #F59E0B;
      --solar-strong: #ff9f2f;
      --solar-soft: #3a2416;
      --dome-950: #120c08;
      --dome-900: #1d1410;
      --dome-800: #2b1a11;
      --dome-700: #3a2316;
      --slate-400: #d2a777;
      --slate-300: #d2a777;
      --slate-200: #5e3a22;
      --paper: #120c08;
      --card: #1d1410;
      --ink: #ffe7c2;
      --muted: #d2a777;
      --ok: #9be9c3;
      --warn: #ffd8a8;
      --block: #ffb3a6;
      --ok-bg: rgba(34, 197, 94, 0.16);
      --warn-bg: rgba(255, 159, 47, 0.22);
      --block-bg: rgba(239, 68, 68, 0.2);
      --border: #5e3a22;
      --shadow: 0 20px 35px -28px rgba(12, 35, 66, 0.45);
      --page-bg: radial-gradient(900px 520px at 0% 0%, #ff8b2f55 0%, transparent 60%),
                 radial-gradient(760px 460px at 100% 0%, #ffbf3f2e 0%, transparent 62%),
                 radial-gradient(860px 480px at 50% 100%, #ff6a0035 0%, transparent 65%),
                 var(--paper);
      --flow-bg: linear-gradient(180deg, #25170f 0%, #1b120d 100%);
      --section-head-bg: linear-gradient(90deg, #2b1a11, #3a2316);
      --h4-color: #ffd8a8;
      --pre-bg: #120b07;
      --th-bg: #3a2316;
      --th-text: #ffe7c2;
      --callout-bg: #3a2416;
      --matrix-bg: #2b1a11;
      --bar-bg: #3a2316;
      --chip-border: rgba(255, 159, 47, 0.35);
      --chip-bg: rgba(58, 36, 22, 0.6);
      --sans: "Avenir Next", "Nunito Sans", "Segoe UI", Arial, sans-serif;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: var(--sans);
      color: var(--ink);
      background: var(--page-bg);
      line-height: 1.55;
    }

    .layout {
      display: grid;
      grid-template-columns: 290px 1fr;
      min-height: 100vh;
    }

    aside {
      background: linear-gradient(180deg, var(--dome-950), var(--dome-900));
      color: #fff;
      padding: 24px 18px;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow: auto;
      border-right: 4px solid var(--solar);
    }

    .brand {
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.18);
    }

    .brand h1 {
      margin: 0;
      font-size: 1.35rem;
      letter-spacing: 0.4px;
    }

    .tag {
      margin-top: 6px;
      color: var(--slate-300);
      font-size: 0.9rem;
    }

    .side-kpis {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-bottom: 14px;
    }

    .side-kpi {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.14);
      border-radius: 10px;
      padding: 8px;
      text-align: center;
    }

    .side-kpi .n {
      font-weight: 700;
      font-size: 1rem;
    }

    .side-kpi .k {
      color: var(--slate-300);
      font-size: 0.76rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    nav a {
      display: block;
      color: #fff;
      text-decoration: none;
      padding: 9px 10px;
      margin: 4px 0;
      border-radius: 10px;
      font-size: 0.95rem;
      transition: background 120ms ease;
    }

    nav a:hover,
    nav a:focus {
      background: rgba(245, 158, 11, 0.2);
      outline: none;
    }

    main {
      padding: 24px;
    }

    .hero {
      border-radius: 18px;
      color: var(--ink);
      background: linear-gradient(132deg, var(--dome-950), var(--dome-800));
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      padding: 22px;
      position: relative;
      overflow: hidden;
    }

    .hero::after {
      content: "";
      position: absolute;
      width: 290px;
      height: 290px;
      right: -110px;
      top: -110px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(245, 158, 11, 0.35), rgba(245, 158, 11, 0));
      pointer-events: none;
    }

    .hero h2 {
      margin: 0;
      font-size: 1.4rem;
      max-width: 820px;
    }

    .hero p {
      color: var(--slate-300);
      margin: 8px 0 0;
      max-width: 860px;
    }

    .chip-row {
      margin-top: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .chip {
      display: inline-block;
      border-radius: 999px;
      padding: 0.3rem 0.72rem;
      font-size: 0.8rem;
      font-weight: 700;
      border: 1px solid var(--chip-border);
      background: var(--chip-bg);
    }

    .chip.solar {
      background: rgba(245, 158, 11, 0.22);
      border-color: rgba(245, 158, 11, 0.36);
      color: #fde68a;
    }

    .kpi-grid {
      margin-top: 14px;
      display: grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 10px;
    }

    .kpi-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 12px;
    }

    .kpi-card .k {
      color: var(--muted);
      font-size: 0.77rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .kpi-card .v {
      font-size: 1.2rem;
      font-weight: 700;
      margin-top: 3px;
    }

    .flow-card {
      margin-top: 14px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 14px;
    }

    .flow {
      display: grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 8px;
      margin-top: 10px;
    }

    .flow-step {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px;
      background: var(--flow-bg);
      min-height: 94px;
      position: relative;
    }

    .flow-step .n {
      font-family: var(--mono);
      font-size: 0.76rem;
      color: var(--solar-strong);
      font-weight: 700;
    }

    .flow-step .t {
      margin-top: 4px;
      font-weight: 700;
      font-size: 0.9rem;
    }

    .flow-step .d {
      margin-top: 4px;
      color: var(--muted);
      font-size: 0.82rem;
    }

    .flow-step:not(:last-child)::after {
      content: ">";
      position: absolute;
      right: -8px;
      top: 40px;
      color: var(--solar-strong);
      font-weight: 700;
      z-index: 2;
    }

    section.doc {
      margin-top: 14px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    .section-head {
      padding: 13px 16px;
      border-bottom: 1px solid var(--border);
      background: var(--section-head-bg);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .section-head h3 {
      margin: 0;
      font-size: 1.05rem;
    }

    .section-body {
      padding: 16px;
    }

    .status {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      padding: 0.2rem 0.65rem;
      font-size: 0.78rem;
      font-weight: 700;
    }

    .allow { background: var(--ok-bg); color: var(--ok); }
    .warn { background: var(--warn-bg); color: var(--warn); }
    .block { background: var(--block-bg); color: var(--block); }

    h4 {
      margin: 1rem 0 0.45rem;
      color: var(--h4-color);
    }

    p { margin: 0.45rem 0 0.85rem; }

    code,
    pre {
      font-family: var(--mono);
      font-size: 0.9rem;
    }

    pre {
      margin: 0.7rem 0;
      background: var(--pre-bg);
      color: #f8fafc;
      border-radius: 10px;
      padding: 12px;
      overflow: auto;
      border: 1px solid var(--border);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.93rem;
      margin: 0.65rem 0;
    }

    th,
    td {
      border: 1px solid var(--border);
      padding: 8px;
      text-align: left;
      vertical-align: top;
    }

    th {
      background: var(--th-bg);
      color: var(--th-text);
    }

    ul,
    ol {
      margin: 0.45rem 0 0.9rem;
      padding-left: 1.2rem;
    }

    .callout {
      background: var(--callout-bg);
      border-left: 4px solid var(--solar);
      border-radius: 9px;
      padding: 10px 12px;
      margin: 0.8rem 0;
    }

    .matrix {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 10px;
      margin-top: 0.6rem;
    }

    .matrix-card {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px;
      background: var(--matrix-bg);
    }

    .matrix-card .stage {
      font-weight: 700;
      color: #fde68a;
      text-transform: uppercase;
      font-size: 0.82rem;
      letter-spacing: 0.08em;
    }

    .bar {
      margin-top: 8px;
      height: 10px;
      border-radius: 999px;
      background: var(--bar-bg);
      overflow: hidden;
      position: relative;
    }

    .allow-zone,
    .warn-zone,
    .block-zone {
      position: absolute;
      top: 0;
      bottom: 0;
    }

    .allow-zone { left: 0; background: #86efac; }
    .warn-zone { background: #fcd34d; }
    .block-zone { right: 0; background: #fca5a5; }

    .muted { color: var(--muted); }

    @media (max-width: 1200px) {
      .kpi-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .flow { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .flow-step:not(:last-child)::after { display: none; }
    }

    @media (max-width: 980px) {
      .layout { grid-template-columns: 1fr; }
      aside {
        position: relative;
        height: auto;
        border-right: none;
        border-bottom: 4px solid var(--solar);
      }
      main { padding: 14px; }
      .matrix { grid-template-columns: 1fr 1fr; }
    }

    @media (max-width: 680px) {
      .kpi-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .flow { grid-template-columns: 1fr; }
      .matrix { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside>
      <div class="brand">
        <h1>security-gate</h1>
        <div class="tag">Solardome local deterministic DevSecOps control</div>
      </div>

      <div class="side-kpis">
        <div class="side-kpi"><div class="n">0/1/2</div><div class="k">Exit contract</div></div>
        <div class="side-kpi"><div class="n">0-100</div><div class="k">Risk scale</div></div>
        <div class="side-kpi"><div class="n">6</div><div class="k">Precedence steps</div></div>
        <div class="side-kpi"><div class="n">Offline</div><div class="k">Execution</div></div>
      </div>

      <nav>
        <a href="#readme">README</a>
        <a href="#architecture">Architecture</a>
        <a href="#core">Core Decision Engine</a>
        <a href="#policy">Policy Format</a>
        <a href="#modules">Modules</a>
        <a href="#governance">Governance: Accepted Risk</a>
      </nav>
    </aside>

    <main>
      <header class="hero">
        <h2>Enterprise-ready, local-first release gate that turns scanner findings into deterministic CI decisions.</h2>
        <p><code>report.json</code> is authoritative for machine consumption. This page is a no-dependency, non-authoritative human summary.</p>
        <div class="chip-row">
          <span class="chip solar">Solardome visual system</span>
          <span class="chip">No cloud dependency</span>
          <span class="chip">Scanner input JSON only</span>
          <span class="chip">Policy/context/AR in strict YAML</span>
          <span class="chip">LLM optional and non-authoritative</span>
        </div>
      </header>

      <section class="kpi-grid" aria-label="spotlight">
        <article class="kpi-card"><div class="k">Decision tokens</div><div class="v">ALLOW | WARN | BLOCK</div></article>
        <article class="kpi-card"><div class="k">Stage precedence</div><div class="v">branch_type primary</div></article>
        <article class="kpi-card"><div class="k">Hard-stops</div><div class="v">Bypass scoring/noise</div></article>
        <article class="kpi-card"><div class="k">Determinism</div><div class="v">Same input, same output</div></article>
        <article class="kpi-card"><div class="k">Risk + trust</div><div class="v">Monotonic and clamped</div></article>
        <article class="kpi-card"><div class="k">Validation mode</div><div class="v">Fail-closed at release</div></article>
      </section>

      <section class="flow-card" aria-label="decision flow infographic">
        <h3 style="margin:0">Decision pipeline infographic</h3>
        <p class="muted" style="margin-top:6px">Deterministic order enforced by the core authority document.</p>
        <div class="flow">
          <div class="flow-step"><div class="n">01</div><div class="t">Hard-stop domains</div><div class="d">Immediate block path, non-overridable.</div></div>
          <div class="flow-step"><div class="n">02</div><div class="t">Accepted risk</div><div class="d">Applies only when valid and in scope.</div></div>
          <div class="flow-step"><div class="n">03</div><div class="t">Risk scoring</div><div class="d">Monotonic model on 0-100 scale.</div></div>
          <div class="flow-step"><div class="n">04</div><div class="t">Noise budget</div><div class="d">Presentation-only, never affects decision.</div></div>
          <div class="flow-step"><div class="n">05</div><div class="t">Stage matrix</div><div class="d">Stage thresholds classify the run.</div></div>
          <div class="flow-step"><div class="n">06</div><div class="t">Exit code mapping</div><div class="d">0=ALLOW, 1=WARN, 2=BLOCK.</div></div>
        </div>
      </section>

      <section id="readme" class="doc">
        <div class="section-head">
          <h3>README.md</h3>
          <span class="status warn">Operator overview</span>
        </div>
        <div class="section-body">
          <h4>Problem Statement</h4>
          <p>Scanners classify findings. Teams still need deterministic release decisions across inconsistent CI contexts. <code>security-gate</code> classifies runs as <span class="status allow">ALLOW</span>, <span class="status warn">WARN</span>, or <span class="status block">BLOCK</span> with a full decision trace.</p>

          <h4>Key Principles</h4>
          <ul>
            <li>Offline local execution only.</li>
            <li>Deterministic core engine; AI output cannot change decisions.</li>
            <li>Untrusted input handling with SHA-256 provenance.</li>
            <li>Scanner inputs are JSON; policy/accepted-risk inputs are strict YAML; context is YAML or deterministic CI auto-detection.</li>
            <li>Branch-primary stage mapping with secondary tightening only.</li>
            <li><code>report.json</code> is authoritative output.</li>
          </ul>

          <h4>Conceptual Quickstart</h4>
          <ol>
            <li>Provide one or more local scanner JSON files (optionally baseline scanner JSON for new-findings-only mode).</li>
            <li>Provide strict YAML policy file and either context YAML or deterministic CI auto-detected context.</li>
            <li>Optionally provide accepted-risk YAML file.</li>
            <li>Run CLI and consume <code>report.json</code>, <code>report.html</code>, <code>checksums.sha256</code>, <code>security-gate.run.log</code>, and exit code.</li>
          </ol>

          <h4>Why Scanner Severity != Release Decision</h4>
          <p>Scanner severity is one signal. Release classification also uses stage strictness, trust/provenance, exposure/criticality context, accepted-risk validity, and hard-stop domains.</p>

          <h4>Design Authority Chain</h4>
          <div class="callout">
            <p><strong>Authority 1:</strong> <code>docs/md/core-decision-engine.md</code> defines canonical tokens, formulas, precedence, decision matrix, exit code mapping, and authoritative <code>report.json</code> schema.</p>
            <p><strong>Authority 2:</strong> <code>docs/md/policy-format.md</code> defines policy YAML schema and semantics.</p>
            <p class="muted">Other docs reference these authorities and do not redefine them.</p>
          </div>
        </div>
      </section>

      <section id="architecture" class="doc">
        <div class="section-head">
          <h3>docs/md/architecture.md</h3>
          <span class="status warn">System view</span>
        </div>
        <div class="section-body">
          <h4>High-Level Diagram</h4>
          <pre><code>scanner json + optional baseline scanner json + (context yaml | context auto-detect) + policy yaml + accepted-risk yaml
  -> ingest/hash -> normalize -> governance -> score/policy -> decision_trace/report
  -> report.json + report.html + checksums.sha256 + security-gate.run.log + exit code</code></pre>

          <h4>Deterministic vs AI Boundary</h4>
          <table>
            <thead><tr><th>Boundary</th><th>Allowed</th><th>Not Allowed</th></tr></thead>
            <tbody>
              <tr><td>Deterministic core</td><td>Parsing, normalization, scoring, matrix decision, exit mapping</td><td>Heuristic or non-repeatable behavior</td></tr>
              <tr><td>AI optional layer</td><td>Narrative text over fixed recommended step IDs</td><td>Changing risk, decision, or actions</td></tr>
            </tbody>
          </table>

          <h4>Failure Modes</h4>
          <ul>
            <li><code>release/deploy</code>: fail-closed to <code>BLOCK</code> for validation/hash/schema/governance errors.</li>
            <li><code>pr/merge</code>: fail-open-to-<code>WARN</code>, never <code>ALLOW</code> when validation fails.</li>
            <li>YAML validator rejects unknown and duplicate keys and reports field-path plus line diagnostics.</li>
          </ul>

          <h4>Trust/Provenance Flow</h4>
          <p>Scanner pinning/freshness, signing, provenance level, and context completeness map to deterministic penalties. These produce <code>TrustScore</code>, which tightens risk and stage outcomes.</p>
        </div>
      </section>

      <section id="core" class="doc">
        <div class="section-head">
          <h3>docs/md/core-decision-engine.md (Authoritative)</h3>
          <span class="status block">Single source of truth</span>
        </div>
        <div class="section-body">
          <h4>Canonical Tokens</h4>
          <ul>
            <li>Decision: <code>ALLOW</code>, <code>WARN</code>, <code>BLOCK</code></li>
            <li>Exit mapping: <code>0=ALLOW</code>, <code>1=WARN</code>, <code>2=BLOCK</code></li>
            <li>Context enums: <code>branch_type</code>, <code>pipeline_stage</code>, <code>environment</code></li>
          </ul>

          <h4>Precedence Order</h4>
          <ol>
            <li>Hard-stop domains</li>
            <li>Accepted Risk / exceptions</li>
            <li>Numeric risk scoring</li>
            <li>Noise budget (presentation-only)</li>
            <li>Stage decision matrix</li>
            <li>Exit code mapping</li>
          </ol>

          <h4>Hard-Stop Domains</h4>
          <pre><code>HS_SECRET_IN_PROD_PATH
HS_ACTIVE_RUNTIME_MALWARE
HS_UNSIGNED_PROD_ARTIFACT
HS_PROVENANCE_TAMPERED
HS_POLICY_INTEGRITY_BROKEN
HS_KNOWN_EXPLOITED_UNPATCHED</code></pre>
          <p>Hard-stop domains are non-overridable by accepted risk and bypass numeric and noise-budget logic.</p>

          <h4>Stage Mapping Rule</h4>
          <p><code>branch_type</code> is primary. <code>pipeline_stage</code> and <code>environment</code> may only tighten via strictness order <code>pr &lt; merge &lt; release &lt; deploy</code>.</p>

          <h4>Risk and Trust Model</h4>
          <ul>
            <li><code>FindingRiskScore</code> remains in <code>[0,100]</code>.</li>
            <li><code>OverallRiskScore = clamp(max(FindingRiskScore) + context_modifiers + TrustPenalty, 0, 100)</code>.</li>
            <li><code>TrustScore = clamp(100 - sum(penalties), 0, 100)</code>.</li>
            <li>Unknown or missing signals never reduce risk.</li>
          </ul>

          <h4>Decision Matrix Infographic</h4>
          <div class="matrix">
            <div class="matrix-card">
              <div class="stage">PR</div>
              <div class="muted">ALLOW 0-44, WARN 45-74, BLOCK 75-100</div>
              <div class="bar"><span class="allow-zone" style="width:44%"></span><span class="warn-zone" style="left:44%;width:30%"></span><span class="block-zone" style="width:26%"></span></div>
            </div>
            <div class="matrix-card">
              <div class="stage">MERGE</div>
              <div class="muted">ALLOW 0-34, WARN 35-64, BLOCK 65-100</div>
              <div class="bar"><span class="allow-zone" style="width:34%"></span><span class="warn-zone" style="left:34%;width:30%"></span><span class="block-zone" style="width:36%"></span></div>
            </div>
            <div class="matrix-card">
              <div class="stage">RELEASE</div>
              <div class="muted">ALLOW 0-24, WARN 25-49, BLOCK 50-100</div>
              <div class="bar"><span class="allow-zone" style="width:24%"></span><span class="warn-zone" style="left:24%;width:25%"></span><span class="block-zone" style="width:51%"></span></div>
            </div>
            <div class="matrix-card">
              <div class="stage">DEPLOY</div>
              <div class="muted">ALLOW 0-14, WARN 15-34, BLOCK 35-100</div>
              <div class="bar"><span class="allow-zone" style="width:14%"></span><span class="warn-zone" style="left:14%;width:20%"></span><span class="block-zone" style="width:66%"></span></div>
            </div>
          </div>

          <h4>report.json Schema</h4>
          <p>Required top-level fields include inputs digests, context, effective stage, trust, risk, hard-stop, decision, exit_code, findings, accepted_risk, recommended_next_steps, decision_trace, and non-authoritative LLM block.</p>

          <h4>Deterministic recommended_next_steps</h4>
          <p>Only predefined catalog IDs are allowed, sorted by priority then ID. Current stable weights include <code>FIX_HARD_STOP_IMMEDIATELY=100</code> and <code>REFRESH_SCANS=300</code>.</p>

          <h4>Noise Budget</h4>
          <p>Presentation-only capability for PR/merge surfaces; never changes risk or decision and should expose suppression counts/reasons in derived views.</p>

          <h4>Baseline Diff Mode</h4>
          <p>Optional new-findings-only mode can score only findings absent from baseline scans for PR/merge workflows. Hard-stop behavior remains unchanged.</p>
        </div>
      </section>

      <section id="policy" class="doc">
        <div class="section-head">
          <h3>docs/md/policy-format.md (Authoritative)</h3>
          <span class="status warn">Strict YAML schema</span>
        </div>
        <div class="section-body">
          <h4>Schema Contract</h4>
          <p>Supported version: <code>schema_version: "1.0"</code>.</p>
          <pre><code>schema_version
policy_id
policy_name
defaults
stage_overrides
trust_tightening
domain_overrides
noise_budget
exception_rules
rules</code></pre>

          <h4>Stage-Aware Conditions</h4>
          <p>Rules can filter by stage, branch type, environment, repo criticality, exposure, and change type. Actions are deterministic tightening only.</p>

          <h4>Domain Overrides</h4>
          <ul>
            <li><code>additional_hard_stops</code> can only add domains.</li>
            <li><code>severity_boosts</code> apply non-negative point increases.</li>
            <li>Canonical hard-stop domains cannot be removed by policy.</li>
          </ul>

          <h4>Exception and Trust Controls</h4>
          <ul>
            <li>Release/deploy approval requirements for exception usage.</li>
            <li>Trust floors plus trust-band risk penalties.</li>
            <li>Unknown schema or invalid fields are validation failures.</li>
          </ul>
        </div>
      </section>

      <section id="modules" class="doc">
        <div class="section-head">
          <h3>docs/md/modules.md</h3>
          <span class="status warn">Implementation map</span>
        </div>
        <div class="section-body">
          <h4>Module Set</h4>
          <table>
            <thead><tr><th>Module</th><th>Purpose</th><th>Key Security Note</th></tr></thead>
            <tbody>
              <tr><td><code>cmd/cli</code></td><td>CLI orchestration and exit mapping</td><td>Never execute scanner-derived content</td></tr>
              <tr><td><code>ingest/*</code></td><td>Trivy + SARIF 2.1.0 + Snyk + Checkmarx v2 + Sonar Generic adapter ingestion</td><td>Treat every field as untrusted input</td></tr>
              <tr><td><code>normalize</code></td><td>Adapter to UnifiedFinding conversion</td><td>Unknowns map deterministically</td></tr>
              <tr><td><code>score</code></td><td>Trust/risk scoring and aggregation</td><td>Monotonic, clamped calculations</td></tr>
              <tr><td><code>policy</code></td><td>Policy schema validation and resolution</td><td>Strict YAML schema, no remote refs</td></tr>
              <tr><td><code>decision_trace</code></td><td>Ordered decision evidence capture</td><td>Redact sensitive values in traces</td></tr>
              <tr><td><code>governance</code></td><td>Accepted-risk validation and application</td><td>Hard-stop non-overridable</td></tr>
              <tr><td><code>report</code></td><td>Authoritative JSON + derived HTML writer</td><td>Escape HTML and preserve authority boundary</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <section id="governance" class="doc">
        <div class="section-head">
          <h3>docs/md/governance-accepted-risk.md</h3>
          <span class="status warn">Offline governance</span>
        </div>
        <div class="section-body">
          <h4>Accepted Risk Schema</h4>
          <pre><code>schema_version: "1.0"
records:
  - id
    status
    owner
    approvers
    ticket
    rationale
    scope
    constraints
    timeline
    metadata</code></pre>

          <h4>Validation Rules</h4>
          <ul>
            <li>Required fields and enums must be valid.</li>
            <li><code>expires_at</code> must be RFC3339 and greater than <code>created_at</code>.</li>
            <li>Expired active records are invalid for application.</li>
            <li>Invalid records trigger stage-based fail behavior.</li>
          </ul>

          <h4>Approval Rules</h4>
          <ul>
            <li>Release + critical and deploy + high-or-above may require security approval per policy.</li>
            <li>Approvals are represented in local YAML only for MVP.</li>
          </ul>

          <h4>Escalation and Audit</h4>
          <ul>
            <li>Near expiry emits deterministic step: <code>REVIEW_ACCEPTED_RISK_EXPIRY</code>.</li>
            <li>Applied and rejected record IDs are recorded in authoritative <code>report.json</code>.</li>
          </ul>
        </div>
      </section>
    </main>
  </div>
</body>
</html>
