# Simulation Scenarios

These deterministic local scenarios are generated by:

```bash
./scripts/simulate.sh
```

## Included cases

- `warn`: fixed YAML context, expected `WARN` (`exit 1`)
- `block`: fixed YAML context + hard-stop finding, expected `BLOCK` (`exit 2`)
- `block-sarif-pr`: SARIF 2.1.0 scan in PR context, expected `BLOCK` (`exit 2`)
- `block-snyk-pr`: Snyk JSON scan in PR context, expected `BLOCK` (`exit 2`)
- `block-checkmarx-pr`: Checkmarx JSON v2 scan in PR context, expected `BLOCK` (`exit 2`)
- `block-sonar-pr`: Sonar Generic Issues JSON scan in PR context, expected `BLOCK` (`exit 2`)
- `block-context-auto-github-pr`: CI auto-detected context (`--context-auto`) using a deterministic GitHub PR env snapshot, expected `BLOCK` (`exit 2`)
- `allow-new-findings-only-baseline-all`: baseline diff mode (`--new-findings-only` + `--baseline-scan`) where all findings are already known, expected `ALLOW` (`exit 0`)

## Fixtures

- Current scan: `scanner-report.warn.json`
- Equivalent SARIF scan: `scanner-report.warn.sarif.json`
- Equivalent Snyk JSON scan: `scanner-report.warn.snyk.json`
- Equivalent Checkmarx JSON v2 scan: `scanner-report.warn.checkmarx.json`
- Equivalent Sonar Generic Issues JSON scan: `scanner-report.warn.sonar.json`
- Full baseline for diff example: `scanner-report.warn.baseline-all.json`
- PR context for baseline diff example: `context.pr-feature.yaml`

Manual SARIF run example:

```bash
./security-gate \
  --scan examples/simulation/scanner-report.warn.sarif.json \
  --context examples/simulation/context.pr-feature.yaml \
  --policy examples/simulation/policy.yaml \
  --out-json report.json \
  --out-html report.html
```
